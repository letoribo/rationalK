)]}'
{"version":3,"sources":["rationalk:sheetconnector//Users/thomasdokithonon/rationalK/packages/rationalk-sheetconnector/package-tap.i18n","rationalk:sheetconnector/lib/methods.js","rationalk:sheetconnector/lib/collections.js","rationalk:sheetconnector/lib/routes.js","rationalk:sheetconnector/lib/client/external.html","rationalk:sheetconnector/lib/client/external.js","rationalk:sheetconnector/lib/client/sheetInSearchResults.html","rationalk:sheetconnector/lib/client/sheetInSearchResults.js","rationalk:sheetconnector//Users/thomasdokithonon/rationalK/packages/rationalk-sheetconnector/i18n/en.i18n.json","rationalk:sheetconnector//Users/thomasdokithonon/rationalK/packages/rationalk-sheetconnector/i18n/fr.i18n.json"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,0H;;AAEA,+D;AACA,gD;AACA,2C;AACA,oF;AACA,uH;;AAEA,qD;AACA,6B;AACA,yC;;;;;;;;;;;;;;;;;;;ACVA,sB;AACA,mC;AACA,iC;AACA,G;AACA,2G;AACA,G;AACA,E;;AAEA,sD;AACA,wD;AACA,E;;AAEA,wD;AACA,S;AACA,qB;AACA,K;AACA,c;AACA,6B;AACA,Q;AACA,M;AACA,K;AACA,kD;AACA,gD;AACA,kB;AACA,O;AACA,Y;AACA,E;;AAEA,0C;AACA,8E;AACA,E;;;;;;;;;;;;;;;;;;;AC9BA,4C;;AAEA,iB;AACA,iD;AACA,gD;AACA,kD;AACA,G;;AAEA,sB;AACA,kD;AACA,iE;AACA,E;AACA,O;AACA,oD;AACA,mE;AACA,G;AACA,E;AACA,C;;AAEA,iC;AACA,2D;;;;;;;;;;;;;;;;;;;ACpBA,iD;AACA,6C;AACA,qB;AACA,qC;AACA,yB;AACA,gE;AACA,yC;AACA,O;AACA,c;AACA,mE;AACA,Q;AACA,M;AACA,K;AACA,C;;;;;;;;;;;;;;;;;;;;ACZA,iC;AACA,sE;AACA,kB;AACA,mB;AACA,kB;AACA,uB;AACA,wB;AACA,yB;AACA,kC;AACA,2B;AACA,6B;AACA,8B;AACA,2B;AACA,0B;AACA,wC;AACA,4D;AACA,0D;AACA,4D;AACA,uM;AACA,yB;AACA,iD;AACA,Y;AACA,yD;AACA,M;AACA,iB;AACA,mE;AACA,mD;AACA,I;;;;;;;;;;;;;;;;;;;AC5BA,0C;AACA,2D;AACA,6C;AACA,4B;AACA,8C;AACA,E;AACA,4D;AACA,E;;AAEA,0B;AACA,sC;AACA,mD;AACA,qB;AACA,4D;AACA,G;AACA,G;;AAEA,2B;AACA,yB;AACA,uE;AACA,uB;AACA,Y;AACA,I;AACA,6B;AACA,wC;AACA,I;AACA,G;;;;;;;;;;;;;;;;;;;;ACzBA,6C;AACA,8F;AACA,kB;AACA,mB;AACA,mB;AACA,uB;AACA,kB;AACA,wB;AACA,wB;AACA,sC;AACA,kD;AACA,iB;AACA,uF;AACA,2D;AACA,uD;AACA,sD;AACA,oB;AACA,mC;AACA,uB;AACA,0B;AACA,kC;AACA,wC;AACA,kE;AACA,4D;AACA,4D;AACA,qD;AACA,sB;AACA,kF;AACA,uE;AACA,U;AACA,M;AACA,uB;AACA,iF;AACA,K;AACA,oJ;AACA,qE;AACA,iB;AACA,kE;AACA,kE;AACA,0D;AACA,0D;AACA,oB;AACA,gC;AACA,I;;;;;;;;;;;;;;;;;;;AC5CA,sC;;AAEA,G;;AAEA,uC;AACA,0C;AACA,0D;AACA,G;AACA,yB;AACA,4C;AACA,G;AACA,G;;;;;;;;;;;;;;;;;;;ACXA,6B;AACA,8C;AACA,2C;;AAEA,gC;AACA,yD;AACA,C;AACA,gD;AACA,kB;AACA,wG;AACA,gD;AACA,8E;;AAEA,oD;AACA,8C;;AAEA,yC;AACA,C;;;;;;;;;;;;;;;;;;;ACjBA,6B;AACA,8C;AACA,2C;;AAEA,gC;AACA,yD;AACA,C","file":"/packages/rationalk_sheetconnector.js","sourcesContent":["TAPi18n.packages[\"rationalk:sheetconnector\"] = {\"translation_function_name\":\"__\",\"helper_name\":\"_\",\"namespace\":\"project\"};\n\n// define package's translation function (proxy to the i18next)\n__ = TAPi18n._getPackageI18nextProxy(\"project\");\n// define the package's templates registrar\nregisterI18nTemplate = TAPi18n._getRegisterHelpersProxy(\"rationalk:sheetconnector\");\nregisterTemplate = registerI18nTemplate; // XXX OBSOLETE, kept for backward compatibility will be removed in the future\n\n// Record the list of templates prior to package load\nvar _ = Package.underscore._;\nnon_package_templates = _.keys(Template);\n","RKSheetConnector = {};\nRKSheetConnector.Collections =  {};\nRKCore.searchResultsPackage.push(\n  {\n    name: \"RKSheetConnector\", // a publication with the name : RKSheetConnector-searchResults should exists\n  }\n);\n\nRKSheetConnector.findAllFullTextSearch = function () {\n  return External.find({}, {sort: {score: -1}}).fetch();\n};\n\nRKSheetConnector.findFullText = function (searchQuery) {\n  var sr;\n  sr = External.find(\n    {\n      $text: {\n        $search: searchQuery,\n      },\n    },\n    {\n        fields: { score: { $meta: 'textScore' } },\n        sort: { score: { $meta: 'textScore' } },\n        limit: 30,\n    });\n  return sr;\n};\n\nRKSheetConnector.findDummy = function () {\n  return External.find({$text: { $search: \"somethingthatyouwillneverfind\" }});\n};\n","External = new Mongo.Collection('external');\n\nExternal.allow( {\n\t\tinsert: function (userId) {return !! userId; },\n\t\tupdate: function (userId) {return !!userId; },\n    remove: function (userId) {return !!userId; },\n});\n\nif (Meteor.isServer) {\n\tif (typeof External.createIndex === 'function') {\n\t\tExternal.createIndex({ \"$**\": \"text\" }, { name: \"TextIndex\" });\n\t}\n\telse {\n\t\tif (typeof External._ensureIndex === 'function') {\n\t\t\tExternal._ensureIndex({ \"$**\": \"text\" }, { name: \"TextIndex\" });\n\t\t}\n\t}\n}\n\n// Expose collections if needed :\n//RKWiki.Collections.WikiSearchResults = WikiSearchResults;\n","if (Meteor.settings.public.show.sheetconnector) {\n  Router.route(\"/external/:externalDocId?\", {\n    name: \"external\",\n    layoutTemplate: 'externalLayout',\n    waitOn: function () {\n      if (typeof Session.get(\"externalDocId\") === 'undefined') {\n        Session.set(\"externalDocId\", \"\");\n      }\n      return [\n        Meteor.subscribe(\"external\", Session.get('externalDocId')),\n      ];\n    },\n  });\n}\n","\nTemplate.__checkName(\"external\");\nTemplate[\"external\"] = new Template(\"Template.external\", (function() {\n  var view = this;\n  return HTML.DIV({\n    \"class\": \"row\"\n  }, \"\\n\t\t\", HTML.DIV({\n    \"class\": \"col-md-12\"\n  }, \"\\n\t\t\t \", HTML.DIV({\n    \"class\": \"panel panel-default\"\n  }, \"\\n\t\t\t\t \t\", HTML.DIV({\n    \"class\": \"panel-heading\",\n    style: \"position:relative\"\n  }, \"\\n\t\t\t\t \t\t\", HTML.H3({\n    \"class\": \"panel-title\"\n  }, Blaze.View(\"lookup:_\", function() {\n    return Spacebars.mustache(view.lookup(\"_\"), \"External\");\n  }), \" \", Blaze.View(\"lookup:externalDocId\", function() {\n    return Spacebars.mustache(view.lookup(\"externalDocId\"));\n  }), \" \", HTML.Raw('<!-- <a href=\"#\" class=\"pull-right updateExcel\" id=\"updateExcel\" title=\"Update\"><span class=\"glyphicon glyphicon-refresh\"></span></a>-->')), \"\\n\t        \"), \"\\n\t\t\t\t\t\", HTML.DIV({\n    \"class\": \"panel-body\"\n  }, \"\\n\t\t\t\t\t\t\", Blaze._TemplateWith(function() {\n    return {\n      collection: Spacebars.call(view.lookup(\"external\"))\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"reactiveTable\"));\n  }), \"\\n\t        \"), \"\\n\t    \t\"), \"\\n\t\t\"), \"\\n\t\");\n}));\n","Template.external.rendered = function () {\n\tvar externalDocId = Router.current().params.externalDocId;\n\tif (typeof(externalDocId) !== 'undefined') {\n\t\tRKCore.log(externalDocId);\n\t\tSession.set('externalDocId', externalDocId);\n\t}\n\tMeteor.call('updateExcel', externalDocId, function () {} );\n};\n\nTemplate.external.events({\n\t\"click a.updateExcel\": function (e) {\n\t\tvar externalDocId = Session.get('externalDocId');\n\t\te.preventDefault();\n\t\tMeteor.call('updateExcel', externalDocId, function () {});\n\t},\n});\n\nTemplate.external.helpers({\n  external: function () {\n    return External.find({}, //find all because other are not published\n\t\t\t{ externalDocId: 0 }\n\t\t).fetch();\n  },\n\texternalDocId: function () {\n    return Session.get('externalDocId');\n  },\n});\n","\nTemplate.__checkName(\"sheetInSearchResults\");\nTemplate[\"sheetInSearchResults\"] = new Template(\"Template.sheetInSearchResults\", (function() {\n  var view = this;\n  return HTML.DIV({\n    \"class\": \"post\"\n  }, \"\\n\t\t\", HTML.DIV({\n    \"class\": \"row\"\n  }, \"\\n\t\t\t\", HTML.DIV({\n    \"class\": \"col-md-10\"\n  }, \"\\n\t\t\t\t\", Blaze.Each(function() {\n    return Spacebars.call(view.lookup(\"content\"));\n  }, function() {\n    return [ \"\\n\t\t\t\t\t\", HTML.P(HTML.STRONG(Blaze.View(\"lookup:headerName\", function() {\n      return Spacebars.mustache(view.lookup(\"headerName\"));\n    }), \" : \"), Blaze.View(\"lookup:value\", function() {\n      return Spacebars.mustache(view.lookup(\"value\"));\n    })), \"\\n\t\t\t\t\" ];\n  }), \"\\n\t\t\t\"), \"\\n\t\t\t\", HTML.DIV({\n    \"class\": \"col-md-2\"\n  }, \"\\n\t\t\t\t\", HTML.SPAN({\n    \"class\": \"label label-default\"\n  }, Blaze.View(\"lookup:_\", function() {\n    return Spacebars.mustache(view.lookup(\"_\"), \"External sheet\");\n  }), \" : \", Blaze.View(\"lookup:externalDocId\", function() {\n    return Spacebars.mustache(view.lookup(\"externalDocId\"));\n  })), \"\\n\t\t\t\t\", HTML.Raw(\"<br>\"), \"\\n\t\t\t\t\", HTML.A({\n    href: function() {\n      return Spacebars.mustache(view.lookup(\"pathFor\"), \"external\", Spacebars.kw({\n        externalDocId: Spacebars.dot(view.lookup(\".\"), \"externalDocId\")\n      }));\n    },\n    title: function() {\n      return Spacebars.mustache(view.lookup(\"_\"), \"View the published document\");\n    }\n  }, HTML.Raw('<span class=\"glyphicon glyphicon-eye-open\" aria-hidden=\"true\"></span>')), \"\\n\t\t\t\t\", HTML.Raw(\"<br>\"), \"\\n\t\t\t\t\", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"searchTypeIsFullTextSearch\"));\n  }, function() {\n    return [ \"\\n\t\t\t\t\t\", HTML.P(Blaze.View(\"lookup:_\", function() {\n      return Spacebars.mustache(view.lookup(\"_\"), \"Search score\");\n    }), \" : \", Blaze.View(\"lookup:textScore\", function() {\n      return Spacebars.mustache(view.lookup(\"textScore\"));\n    })), \"\\n\t\t\t\t\" ];\n  }), \"\\n\t\t\t\"), \"\\n\t\t\"), \"\\n\t\");\n}));\n","Template.sheetInSearchResults.events({\n\n});\n\nTemplate.sheetInSearchResults.helpers({\n\tsearchTypeIsFullTextSearch: function () {\n\t\treturn (Session.get('searchType') === 'fullTextSearch');\n\t},\n\ttextScore: function () {\n\t\treturn Math.round(this.score * 100) / 100;\n\t},\n});\n","var _ = Package.underscore._,\n    package_name = \"rationalk:sheetconnector\",\n    namespace = \"rationalk:sheetconnector\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n// integrate the fallback language translations \ntranslations = {};\ntranslations[namespace] = {\"invitation_to_join_info_login\":\"Your username will be your company email.\"};\nTAPi18n._loadLangFileObject(\"en\", translations);\nvar package_templates = _.difference(_.keys(Template), non_package_templates);\n\nfor (var i = 0; i < package_templates.length; i++) {\n  var package_template = package_templates[i];\n\n  registerI18nTemplate(package_template);\n}\n","var _ = Package.underscore._,\n    package_name = \"rationalk:sheetconnector\",\n    namespace = \"rationalk:sheetconnector\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n"]}