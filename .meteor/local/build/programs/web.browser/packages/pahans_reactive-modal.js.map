)]}'
{"version":3,"sources":["pahans:reactive-modal/lib/reactive-modal.html","pahans:reactive-modal/lib/reactive-modal.js","pahans:reactive-modal/lib/ev.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,uC;AACA,kF;AACA,kB;AACA,mB;AACA,0B;AACA,oB;AACA,oD;AACA,M;AACA,mB;AACA,mB;AACA,mC;AACA,iE;AACA,M;AACA,yB;AACA,yB;AACA,yB;AACA,sF;AACA,K;AACA,2B;AACA,4B;AACA,6B;AACA,2B;AACA,wJ;AACA,2B;AACA,oB;AACA,iE;AACA,K;AACA,4B;AACA,oD;AACA,8C;AACA,yB;AACA,kF;AACA,K;AACA,6N;AACA,8C;AACA,iB;AACA,yC;AACA,0E;AACA,O;AACA,6C;AACA,yB;AACA,sF;AACA,K;AACA,4C;AACA,mF;AACA,iB;AACA,uD;AACA,qB;AACA,sB;AACA,8E;AACA,Q;AACA,2B;AACA,kK;AACA,Q;AACA,kC;AACA,0D;AACA,O;AACA,mB;AACA,6D;AACA,+B;AACA,+E;AACA,0B;AACA,qD;AACA,I;;;;;;;;;;;;;;;;;;;AChEA,iB;AACA,2B;AACA,mB;AACA,oB;AACA,E;AACA,mD;AACA,iC;AACA,oB;AACA,Y;AACA,mB;AACA,gC;AACA,K;AACA,e;AACA,I;AACA,uB;AACA,qC;AACA,uB;AACA,Y;AACA,kB;AACA,K;AACA,I;AACA,sB;AACA,sC;AACA,qB;AACA,K;AACA,I;AACA,0B;AACA,gB;AACA,iE;AACA,kB;AACA,G;AACA,G;;AAEA,gC;AACA,6D;AACA,2C;AACA,G;AACA,G;;AAEA,2C;AACA,gC;AACA,8B;AACA,2D;AACA,U;AACA,mB;AACA,wB;;AAEA,oC;AACA,oD;AACA,oC;AACA,uC;AACA,6J;AACA,oJ;AACA,uE;AACA,qE;AACA,M;AACA,E;AACA,uE;AACA,G;;AAEA,iC;AACA,yB;AACA,8B;AACA,G;AACA,yB;AACA,8B;AACA,G;;AAEA,0B;AACA,kD;AACA,uB;AACA,O;AACA,G;;AAEA,iC;AACA,c;AACA,E;;;;;;;;;;;;;;;;;;;AC5EA,iB;AACA,wB;AACA,C;;AAEA,0C;AACA,sD;AACA,sB;;AAEA,+B;AACA,kD;AACA,2C;AACA,+B;AACA,gC;AACA,qB;AACA,K;AACA,G;;AAEA,oC;AACA,kB;AACA,G;AACA,c;AACA,E;;AAEA,gD;AACA,gC;AACA,iC;AACA,G;AACA,yC;AACA,c;AACA,E;;AAEA,oD;AACA,6C;AACA,oC;AACA,gD;AACA,K;AACA,c;AACA,E;;AAEA,wE;AACA,+B;AACA,0D;AACA,2D;AACA,G;AACA,c;AACA,E;;AAEA,sE;AACA,sC;AACA,c;AACA,E","file":"/packages/pahans:reactive-modal.js","sourcesContent":["\nTemplate.__checkName(\"_reactiveModal\");\nTemplate[\"_reactiveModal\"] = new Template(\"Template._reactiveModal\", (function() {\n  var view = this;\n  return HTML.DIV({\n    \"class\": \"modal fade\",\n    id: function() {\n      return Spacebars.mustache(view.lookup(\"key\"));\n    },\n    tabindex: \"-1\",\n    role: \"dialog\",\n    \"aria-labelledby\": function() {\n      return [ Spacebars.mustache(view.lookup(\"key\")), \"Label\" ];\n    },\n    \"aria-hidden\": \"true\"\n  }, \"\\n    \", HTML.DIV({\n    \"class\": function() {\n      return [ \"modal-dialog \", Spacebars.mustache(view.lookup(\"modalDialogClass\")) ];\n    }\n  }, \"\\n      \", HTML.DIV({\n    \"class\": \"modal-content\"\n  }, \"\\n        \", HTML.DIV({\n    \"class\": \"modal-header\"\n  }, \"\\n          \", HTML.Raw('<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>'), \"\\n          \", HTML.H4({\n    \"class\": \"modal-title\",\n    id: function() {\n      return [ Spacebars.mustache(view.lookup(\"key\")), \"Label\" ];\n    }\n  }, Blaze.View(function() {\n    return Spacebars.mustache(view.lookup(\"title\"));\n  })), \"\\n        \"), \"\\n        \", HTML.DIV({\n    \"class\": function() {\n      return [ \"modal-body \", Spacebars.mustache(view.lookup(\"modalBodyClass\")) ];\n    }\n  }, \"\\n          \", HTML.Raw(\"<!-- strange: {{> template}} works fine, but with the data context, template is searched inside the data context (the second variable) -->\"), \"\\n          \", Blaze._TemplateWith(function() {\n    return Spacebars.call(view.lookup(\"doc\"));\n  }, function() {\n    return Spacebars.include(function() {\n      return Spacebars.call(Spacebars.dot(view.lookup(\"..\"), \"template\"));\n    });\n  }), \"\\n        \"), \"\\n        \", HTML.DIV({\n    \"class\": function() {\n      return [ \"modal-footer \", Spacebars.mustache(view.lookup(\"modalFooterClass\")) ];\n    }\n  }, \"\\n          \", Blaze.Each(function() {\n    return Spacebars.dataMustache(view.lookup(\"arrayify\"), view.lookup(\"buttons\"));\n  }, function() {\n    return [ \"\\n            \", HTML.BUTTON(HTML.Attrs({\n      type: \"button\",\n      id: function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"button\"), \"id\"));\n      },\n      \"class\": function() {\n        return [ \"btn \", Spacebars.mustache(Spacebars.dot(view.lookup(\"button\"), \"class\")), \" \", Spacebars.mustache(view.lookup(\"name\")), \" reactive-modal-btn\" ];\n      },\n      \"data-dismiss\": function() {\n        return Spacebars.mustache(view.lookup(\"dismiss\"));\n      }\n    }, function() {\n      return Spacebars.attrMustache(view.lookup(\"disabled\"));\n    }), Blaze.View(function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"button\"), \"label\"));\n    })), \"\\n          \" ];\n  }), \"\\n        \"), \"\\n      \"), \"\\n    \"), \"\\n  \");\n}));\n","var _modals = {};\nReactiveModal = function(){\n  // EV.call(this);\n  this.buttons = {};\n};\n// _.extend(ReactiveModal.prototype, EV.prototype);\nTemplate._reactiveModal.helpers({\n  class: function(){\n    var att;\n    if(this.class){\n      att = 'btn ' + this.class;\n    }\n    return att;\n  },\n  disabled: function(){\n    if (this.button.disabled.get()) {\n      return \"disabled\"\n    } else {\n      return null;\n    }\n  },\n  dismiss: function(){\n    if(this.button.closeModalOnClick){\n      return \"modal\";\n    }\n  },\n  arrayify: function(obj){\n    result = [];\n    for (var key in obj) result.push({name:key,button:obj[key]});\n    return result;\n  }\n});\n\nTemplate._reactiveModal.events({\n  'click .modal-footer .reactive-modal-btn.btn': function(e){\n    this.button.emit('click', this.button);\n  }\n});\n\nReactiveModal.initDialog = function (info){\n  var key = \"rm-\"+Meteor.uuid();\n  if(!info || !info.template){\n    console.error(\"you must define a template for \" , key);\n  } else {\n    info.key = key;\n    _modals[key] = info;\n\n    for(var button in info.buttons){\n      var newButton = _.clone(info.buttons[button]);\n      _.extend(newButton, new EV());\n      info.buttons[button] = newButton;\n      newButton.closeModalOnClick = (info.buttons[button].closeModalOnClick === undefined || info.buttons[button].closeModalOnClick === true) ? true : false;\n      newButton.disabled = new ReactiveVar((info.buttons[button].disabled === undefined || info.buttons[button].disabled === false) ? false : true);\n      newButton.disable =  function () {newButton.disabled.set(true);},\n      newButton.enable = function () {newButton.disabled.set(false);}\n    };\n  \n    Blaze.renderWithData(Template._reactiveModal, info, document.body);\n  }\n\n  var modalTarget = $('#' + key);\n  info.show = function(){\n    modalTarget.modal('show');\n  }\n  info.hide = function(){\n    modalTarget.modal('hide');\n  }\n\n  if (info.removeOnHide) {\n    modalTarget.on('hidden.bs.modal', function() {\n      $(this).remove();\n    });\n  }\n\n  info.modalTarget = modalTarget;\n  return info;\n};\n","EV = function() {\n  this._evHandlers = {};\n}\n\nEV.prototype.emit = function emit(event) {\n  var args = Array.prototype.slice.call(arguments, 1);\n  var emitted = false;\n\n  if(this._evHandlers[event]) {\n    var events = _.clone(this._evHandlers[event]);\n    for(var lc=0; lc<events.length; lc++) {\n      var handler = events[lc];\n      handler.apply(this, args);\n      emitted = true;\n    }\n  }\n\n  if(event == 'error' && !emitted) {\n    throw args[0];\n  }\n  return this;\n};\n\nEV.prototype.on = function on(event, callback) {\n  if(!this._evHandlers[event]) {\n    this._evHandlers[event] = [];\n  }\n  this._evHandlers[event].push(callback);\n  return this;\n};\n\nEV.prototype.once = function once(event, callback) {\n  this.on(event, function onetimeCallback() {\n    callback.apply(this, arguments);\n    this.removeListener(event, onetimeCallback);\n  });\n  return this;\n};\n\nEV.prototype.removeListener = function removeListener(event, callback) {\n  if(this._evHandlers[event]) {\n    var index = this._evHandlers[event].indexOf(callback);\n    var removed = this._evHandlers[event].splice(index, 1);\n  }\n  return this;\n};\n\nEV.prototype.removeAllListeners = function removeAllListeners(event) {\n  this._evHandlers[event] = undefined;\n  return this;\n};"]}